{
  "info": {
    "_postman_id": "employee-module-integration-tests",
    "name": "Employee Module Integration Tests",
    "description": "Integration tests for Employee Controller endpoints",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Setup",
      "item": [
        {
          "name": "1. Login - Admin (Get Admin Token)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Admin login successful - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contains token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('accessToken');",
                  "    pm.environment.set('adminToken', jsonData.accessToken);",
                  "    console.log('Admin token obtained');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phone\": \"{{adminPhone}}\",\n    \"password\": \"{{adminPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "2. Create Test Employee (Normal User)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Create employee - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Save created employee ID', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('employeeId');",
                  "    pm.environment.set('createdEmployeeId', jsonData.employeeId);",
                  "    console.log('Created test employee with ID: ' + jsonData.employeeId);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"employeeName\": \"Test Employee\",\n    \"gender\": \"男性\",\n    \"phone\": \"{{testEmployeePhone}}\",\n    \"email\": \"test.employee@example.com\",\n    \"position\": 3,\n    \"orgId\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/employees",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees"]
            }
          }
        },
        {
          "name": "3. Create Test Leader",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Create leader - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Save created leader ID', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('employeeId');",
                  "    pm.environment.set('createdLeaderId', jsonData.employeeId);",
                  "    console.log('Created test leader with ID: ' + jsonData.employeeId);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"employeeName\": \"Test Leader\",\n    \"gender\": \"男性\",\n    \"phone\": \"{{testLeaderPhone}}\",\n    \"email\": \"test.leader@example.com\",\n    \"position\": 2,\n    \"orgId\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/employees",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees"]
            }
          }
        },
        {
          "name": "4. Login - Test Employee (Get Auth Token)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Employee login successful - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Save employee auth token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('accessToken');",
                  "    pm.environment.set('authToken', jsonData.accessToken);",
                  "    console.log('Employee auth token obtained');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phone\": \"{{testEmployeePhone}}\",\n    \"password\": \"{{testEmployeePassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "5. Login - Test Leader (Get Leader Token)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Leader login successful - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Save leader auth token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('accessToken');",
                  "    pm.environment.set('leaderAuthToken', jsonData.accessToken);",
                  "    console.log('Leader auth token obtained');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phone\": \"{{testLeaderPhone}}\",\n    \"password\": \"{{testLeaderPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        }
      ]
    },
    {
      "name": "Negative Tests - Expected Failures",
      "item": [
        {
          "name": "Login - Wrong Password (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Wrong password rejected - Status 401 or 400', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 401, 403]);",
                  "});",
                  "",
                  "pm.test('Response should not contain token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.not.have.property('token');",
                  "});",
                  "",
                  "pm.test('Response contains error message', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.satisfy(function(data) {",
                  "        return data.error || data.message || data.msg;",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"{{testUsername}}\",\n    \"password\": \"wrongPassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Login - Non-existent User (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Non-existent user rejected - Status 401 or 404', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 401, 404]);",
                  "});",
                  "",
                  "pm.test('Response should not contain token', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.not.have.property('token');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"nonExistentUser12345\",\n    \"password\": \"anyPassword\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Login - Empty Username (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Empty username rejected - Status 400', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 401]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"\",\n    \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Login - Empty Password (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Empty password rejected - Status 400', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 401]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"{{testUsername}}\",\n    \"password\": \"\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Login - Missing Body (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Missing body rejected - Status 400', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 415]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Access with Invalid Token (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Invalid token rejected - Status 401 or 403', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([401, 403]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer invalid.token.here123456"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/me",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me"]
            }
          }
        },
        {
          "name": "Access with Expired Token Format (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Malformed token rejected - Status 401 or 403', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([401, 403]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/me",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me"]
            }
          }
        },
        {
          "name": "Weekly Stats - Invalid Date Format (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Invalid date format rejected - Status 400', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 500]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-stats?date=invalid-date",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-stats"],
              "query": [
                {
                  "key": "date",
                  "value": "invalid-date"
                }
              ]
            }
          }
        },
        {
          "name": "Weekly Stats - Wrong Date Format (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Wrong date format rejected - Status 400', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 500]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-stats?date=29-11-2025",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-stats"],
              "query": [
                {
                  "key": "date",
                  "value": "29-11-2025"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Employee Endpoints",
      "item": [
        {
          "name": "GET /employees/me - Get Current Employee",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get current employee - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is JSON', function () {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "pm.test('Response contains employee data', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('employeeId');",
                  "    pm.expect(jsonData).to.have.property('employeeName');",
                  "});",
                  "",
                  "pm.test('Response time is acceptable', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(2000);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/me",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me"]
            }
          }
        },
        {
          "name": "GET /employees/me - Unauthorized (No Token)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Unauthorized without token - Status 401 or 403', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([401, 403]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/employees/me",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me"]
            }
          }
        },
        {
          "name": "GET /employees/assignable - Get Assignable Employees (Leader)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get assignable employees - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contains employees array', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('employees');",
                  "    pm.expect(jsonData.employees).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Response contains total count', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('total');",
                  "    pm.expect(jsonData.total).to.be.a('number');",
                  "});",
                  "",
                  "pm.test('Employee objects have required fields', function () {",
                  "    const jsonData = pm.response.json();",
                  "    if (jsonData.employees && jsonData.employees.length > 0) {",
                  "        const emp = jsonData.employees[0];",
                  "        pm.expect(emp).to.have.property('employeeId');",
                  "        pm.expect(emp).to.have.property('employeeName');",
                  "        pm.expect(emp).to.have.property('position');",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{leaderAuthToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/assignable",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "assignable"]
            }
          }
        },
        {
          "name": "GET /employees/assignable - Forbidden (Non-Leader)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Non-leader access forbidden - Status 403', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([403, 200]);",
                  "    // Note: If user is also a leader, this will return 200",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/assignable",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "assignable"]
            }
          }
        },
        {
          "name": "PUT /employees/me/password - Change Password",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Change password - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contains success message', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('message');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"newPassword\": \"{{newPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/employees/me/password",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me", "password"]
            }
          }
        },
        {
          "name": "PUT /employees/me/password - Empty Password (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Empty password rejected - Status 400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('Response contains error message', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('error');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"newPassword\": \"\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/employees/me/password",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me", "password"]
            }
          }
        },
        {
          "name": "PUT /employees/me - Update Employee",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Update employee - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contains success message', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('message');",
                  "});",
                  "",
                  "pm.test('Response contains updated employee data', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('employee');",
                  "    pm.expect(jsonData.employee).to.have.property('employeeId');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"employeeName\": \"Updated Name\",\n    \"phone\": \"13800138000\",\n    \"email\": \"updated@example.com\",\n    \"mbti\": \"INTJ\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/employees/me",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me"]
            }
          }
        },
        {
          "name": "PUT /employees/me - Invalid MBTI (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Invalid MBTI rejected - Status 400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"mbti\": \"invalid\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/employees/me",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me"]
            }
          }
        },
        {
          "name": "GET /employees/weekly-stats - Get Weekly Stats",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get weekly stats - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is JSON', function () {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "pm.test('Response contains stats data', function () {",
                  "    const jsonData = pm.response.json();",
                  "    // Verify response structure based on EmployeeWeeklyStatsDTO",
                  "    pm.expect(jsonData).to.be.an('object');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-stats",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-stats"]
            }
          }
        },
        {
          "name": "GET /employees/weekly-stats - With Date Parameter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get weekly stats with date - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is JSON', function () {",
                  "    pm.response.to.be.json;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-stats?date={{testDate}}",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-stats"],
              "query": [
                {
                  "key": "date",
                  "value": "{{testDate}}"
                }
              ]
            }
          }
        },
        {
          "name": "GET /employees/weekly-mood-statistics - Get Weekly Mood Stats",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get weekly mood statistics - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is JSON', function () {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "pm.test('Response contains mood statistics', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('object');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-mood-statistics",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-mood-statistics"]
            }
          }
        },
        {
          "name": "GET /employees/weekly-mood-statistics - With Date Parameter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get weekly mood statistics with date - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is JSON', function () {",
                  "    pm.response.to.be.json;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-mood-statistics?date={{testDate}}",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-mood-statistics"],
              "query": [
                {
                  "key": "date",
                  "value": "{{testDate}}"
                }
              ]
            }
          }
        },
        {
          "name": "GET /employees/weekly-daily-workload - Get Weekly Daily Workload",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get weekly daily workload - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is JSON', function () {",
                  "    pm.response.to.be.json;",
                  "});",
                  "",
                  "pm.test('Response contains workload data', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('object');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-daily-workload",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-daily-workload"]
            }
          }
        },
        {
          "name": "GET /employees/weekly-daily-workload - With Date Parameter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Get weekly daily workload with date - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response is JSON', function () {",
                  "    pm.response.to.be.json;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-daily-workload?date={{testDate}}",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-daily-workload"],
              "query": [
                {
                  "key": "date",
                  "value": "{{testDate}}"
                }
              ]
            }
          }
        },
        {
          "name": "GET /employees/weekly-daily-workload - Unauthorized",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Unauthorized without token - Status 401 or 403', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([401, 403]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/employees/weekly-daily-workload",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "weekly-daily-workload"]
            }
          }
        }
      ]
    },
    {
      "name": "Admin Endpoints",
      "item": [
        {
          "name": "PUT /admin/employees/{id} - Update Employee",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Update employee - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contains updated employee', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('employeeId');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"employeeName\": \"Updated Test Employee\",\n    \"gender\": \"男性\",\n    \"email\": \"updated.test@example.com\",\n    \"phone\": \"{{testEmployeePhone}}\",\n    \"position\": 3,\n    \"orgId\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/employees/{{createdEmployeeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "{{createdEmployeeId}}"]
            }
          }
        },
        {
          "name": "PUT /admin/employees/{id} - Not Found (Boundary)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Update non-existent employee - Status 400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"employeeName\": \"Test\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/employees/99999",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "99999"]
            }
          }
        },
        {
          "name": "PUT /admin/employees/{id}/transfer - Transfer Department",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Transfer department - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/employees/{{createdEmployeeId}}/transfer?departmentId=1",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "{{createdEmployeeId}}", "transfer"],
              "query": [
                {
                  "key": "departmentId",
                  "value": "1"
                }
              ]
            }
          }
        },
        {
          "name": "PUT /admin/employees/{id}/transfer - Invalid Department (Boundary)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Transfer to invalid department - Status 400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/employees/{{createdEmployeeId}}/transfer?departmentId=99999",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "{{createdEmployeeId}}", "transfer"],
              "query": [
                {
                  "key": "departmentId",
                  "value": "99999"
                }
              ]
            }
          }
        },
        {
          "name": "PUT /admin/employees/{id}/position - Update Position",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Update position - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response contains updated employee', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('employeeId');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"newPosition\": \"EMPLOYEE\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/employees/{{createdEmployeeId}}/position",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "{{createdEmployeeId}}", "position"]
            }
          }
        },
        {
          "name": "PUT /admin/employees/{id}/position - Invalid Position (Boundary)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Update invalid position - Status 400 or 500 (invalid enum)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([400, 500]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"newPosition\": null\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/employees/{{createdEmployeeId}}/position",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "{{createdEmployeeId}}", "position"]
            }
          }
        },
        {
          "name": "POST /admin/important-matters - Create Important Matter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Create important matter - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Save created matter ID', function () {",
                  "    const jsonData = pm.response.json();",
                  "    if (jsonData.matterId) {",
                  "        pm.environment.set('createdMatterId', jsonData.matterId);",
                  "        console.log('Created matter ID: ' + jsonData.matterId);",
                  "    } else if (jsonData.id) {",
                  "        pm.environment.set('createdMatterId', jsonData.id);",
                  "        console.log('Created matter ID: ' + jsonData.id);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"title\": \"Test Important Matter\",\n    \"content\": \"This is a test important matter for integration testing\",\n    \"departmentId\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/important-matters",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "important-matters"]
            }
          }
        },
        {
          "name": "POST /admin/important-matters - Empty Title (Boundary)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Create with empty title - Status 400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"title\": \"\",\n    \"description\": \"Test\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/important-matters",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "important-matters"]
            }
          }
        },
        {
          "name": "PUT /admin/important-matters/{id} - Update Important Matter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Update important matter - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"title\": \"Updated Test Important Matter\",\n    \"content\": \"Updated content for testing\",\n    \"departmentId\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/important-matters/{{createdMatterId}}",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "important-matters", "{{createdMatterId}}"]
            }
          }
        },
        {
          "name": "PUT /admin/important-matters/{id} - Not Found (Boundary)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Update non-existent matter - Status 400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"title\": \"Test\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/admin/important-matters/99999",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "important-matters", "99999"]
            }
          }
        },
        {
          "name": "DELETE /admin/important-matters/{id} - Delete Important Matter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Delete important matter - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Cleanup: Clear createdMatterId', function () {",
                  "    pm.environment.unset('createdMatterId');",
                  "    console.log('Test important matter deleted');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/important-matters/{{createdMatterId}}",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "important-matters", "{{createdMatterId}}"]
            }
          }
        },
        {
          "name": "DELETE /admin/important-matters/{id} - Not Found (Boundary)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Delete non-existent matter - Status 200 (deleteById does not throw)', function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/important-matters/99999",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "important-matters", "99999"]
            }
          }
        }
      ]
    },
    {
      "name": "Cleanup",
      "item": [
        {
          "name": "Restore Original Password",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Re-login with new password to get fresh token",
                  "const baseUrl = pm.environment.get('baseUrl');",
                  "const username = pm.environment.get('testUsername');",
                  "const newPassword = pm.environment.get('newPassword');",
                  "",
                  "pm.sendRequest({",
                  "    url: baseUrl + '/auth/login',",
                  "    method: 'POST',",
                  "    header: { 'Content-Type': 'application/json' },",
                  "    body: {",
                  "        mode: 'raw',",
                  "        raw: JSON.stringify({ username: username, password: newPassword })",
                  "    }",
                  "}, function (err, res) {",
                  "    if (!err && res.code === 200) {",
                  "        const token = res.json().token;",
                  "        pm.environment.set('authToken', token);",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Password restored - Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"newPassword\": \"{{testPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/employees/me/password",
              "host": ["{{baseUrl}}"],
              "path": ["employees", "me", "password"]
            }
          }
        },
        {
          "name": "2. Delete Test Employee",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const createdEmployeeId = pm.environment.get('createdEmployeeId');",
                  "",
                  "if (createdEmployeeId) {",
                  "    pm.test('Delete employee - Status 200', function () {",
                  "        pm.response.to.have.status(200);",
                  "    });",
                  "",
                  "    pm.test('Cleanup: Clear createdEmployeeId', function () {",
                  "        pm.environment.unset('createdEmployeeId');",
                  "        console.log('Test employee deleted');",
                  "    });",
                  "} else {",
                  "    pm.test('Skip - No employee to delete', function () {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/employees/{{createdEmployeeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "{{createdEmployeeId}}"]
            }
          }
        },
        {
          "name": "3. Delete Test Leader",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const createdLeaderId = pm.environment.get('createdLeaderId');",
                  "",
                  "if (createdLeaderId) {",
                  "    pm.test('Delete leader - Status 200', function () {",
                  "        pm.response.to.have.status(200);",
                  "    });",
                  "",
                  "    pm.test('Cleanup: Clear createdLeaderId', function () {",
                  "        pm.environment.unset('createdLeaderId');",
                  "        console.log('Test leader deleted');",
                  "    });",
                  "} else {",
                  "    pm.test('Skip - No leader to delete', function () {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/employees/{{createdLeaderId}}",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "employees", "{{createdLeaderId}}"]
            }
          }
        },
        {
          "name": "4. Cleanup Environment Variables",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Cleanup all test tokens', function () {",
                  "    pm.environment.unset('authToken');",
                  "    pm.environment.unset('leaderAuthToken');",
                  "    pm.environment.unset('adminToken');",
                  "    console.log('All test tokens cleaned up');",
                  "    pm.expect(true).to.be.true;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/health",
              "host": ["{{baseUrl}}"],
              "path": ["health"]
            }
          }
        }
      ]
    }
  ]
}
